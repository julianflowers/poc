---
title: "Dashboard"
format: dashboard
---

```{r}
needs(tidyverse, crosstalk, DT, plotly, gt, readxl, Hmisc)

data <- read_csv("data/pop_rates.csv")

amr <- read_xlsx("data/AMR 2022 POC.xlsx") |>
    janitor::clean_names() |>
    select(age_year, community_origin, location, patient_hospitalized, community_origin, pathogen_name:spectinomycin) |>
    pivot_longer(names_to = "antibiotic", values_to = "resistance", cols = 6:last_col()) |>
        mutate(age_band = cut2(age_year, cuts = c(0, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 118))) |>
    count(community_origin, patient_hospitalized, age_band, pathogen_name, antibiotic, resistance)


sharedP <- SharedData$new(data)
shared_amr <- SharedData$new(amr)


```


## {.sidebar}

Simple static dashboard

```{r}
filter_checkbox("path", "Pathogen", shared_amr, ~ pathogen_name)
filter_select("patient_hospitalized", "Hospitalised", shared_amr, ~ patient_hospitalized)
filter_checkbox("community_origin", "Source", shared_amr, ~ community_origin)
filter_select("antibiotic", "Antibiotic", shared_amr, ~ antibiotic)

```


# AMR

## {.toolbar}

## Row {height = 20%}

## Column {width = 70%}

```{r}
#| title: "AMR data"

DT::datatable(shared_amr)

```








# AMR charts


```{r}

amr |>
    head()



```
