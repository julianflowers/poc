[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Proof of concept for health indicators",
    "section": "",
    "text": "1 Introduction\nOutline an end-to-end process for creating public health indicators and generating public health profiles.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "index.html#global-workflow",
    "href": "index.html#global-workflow",
    "title": "Proof of concept for health indicators",
    "section": "1.1 Global workflow",
    "text": "1.1 Global workflow\n\n\n\n\n\n\nflowchart TD\n\nA[Source datasets] --&gt; B[Cleaning] \nB --&gt; C[Recode area names to match across datasets] --&gt; E\nD --&gt; E[Aggregate indicator data by gender, age-band and area]\nB --&gt; D[Create age bands from ages]\nE --&gt; F[Link aggregate indicator data to population data]\nF --&gt; G[Calculate rate and unceratinty intervals]\nG --&gt; H[Pool regional rates across indicators]\nH--&gt; I[Generate regional profile visualisations]\n\nclassDef green fill:#9f6,stroke:#333,stroke-width:2px;\n     classDef orange fill:#f96,stroke:#333,stroke-width:4px;\n     class D,e green\n     class B orange\n\n\n\n\n\n\nFigure 1.1: Workflow",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "ind-def.html",
    "href": "ind-def.html",
    "title": "2  Indicator definitions",
    "section": "",
    "text": "2.1 Anti-microbial resistance\nPercentage of bloodstream infections due to selected antimicrobial-resistant organisms (MRSA, Escherichia coli resistant to 3rd-generation cephalosporin (e.g., ESBL- E. coli))",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Indicator definitions</span>"
    ]
  },
  {
    "objectID": "ind-def.html#anti-microbial-resistance",
    "href": "ind-def.html#anti-microbial-resistance",
    "title": "2  Indicator definitions",
    "section": "",
    "text": "2.1.1 Staphylococcus aureus\n\n\ntitledenominatornumeratormetricnotesPercentage of bloodstream infections due to selected antimicrobial-resistant organisms: MRSATotal No. of patients with growth of S. aureus in tested blood samplesNo. of patients with growth of methicillin-resistant S. aureus in tested blood samplesProportion\n\n\n\n\n2.1.2 Escherichia coli\n\n\ntitledenominatornumeratormetricnotesPercentage of bloodstream infections due to selected antimicrobial-resistant organisms: E.coliTotal No. of patients with growth of E. coli in tested blood samplesNo. of patients with growth of E.coli resistant to 3rd generation cephalosporins in tested blood samplesProportionResistance to ceftazidine, cefotaxine",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Indicator definitions</span>"
    ]
  },
  {
    "objectID": "ind-def.html#smoking",
    "href": "ind-def.html#smoking",
    "title": "2  Indicator definitions",
    "section": "2.2 Smoking",
    "text": "2.2 Smoking\nCurrent cigarette smoking among women aged 18-44 years\n\n\ntitledenominatornumeratormetricnotesPCurrent cigarette smoking among women aged 18-44 yearsWomen aged 18-44 years who information about cigarette smoking (excluding unknowns and refusals).Women aged 18-44 years who reported that they smoked ≥100 cigarettes in their lifetime and currently smoke every day or some days.Rate with 95% confidence intervalsData provided is attendances at smoking clinics rather than survey based smoking prevalence",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Indicator definitions</span>"
    ]
  },
  {
    "objectID": "ind-def.html#injury",
    "href": "ind-def.html#injury",
    "title": "2  Indicator definitions",
    "section": "2.3 Injury",
    "text": "2.3 Injury\nNonfatal hospitalizations for all injuries\n\n\ntitledenominatornumeratormetricnotesNonfatal hospitalizations for all injuriesMidyear population for the calendar year under surveillance obtained from the KSA Census or suitable alternative.Nonfatal hospitalizations with any of the following ICD-10-CM diagnostic codes in the principal diagnosis fieldRate with 95% confidence intervalsData provided is attendances at smoking clinics rather than survey based smoking prevalence",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Indicator definitions</span>"
    ]
  },
  {
    "objectID": "ind-def.html#flu-vaccination-coverage",
    "href": "ind-def.html#flu-vaccination-coverage",
    "title": "2  Indicator definitions",
    "section": "2.4 Flu vaccination coverage",
    "text": "2.4 Flu vaccination coverage\n\n2.4.1 Paediatric\n\n\ntitledenominatornumeratormetricnotesPopulation vaccination coverage - Flu (pediatric group 6 months - 18 years old))The total number of children eligible for influenza vaccinationThe total number of children in the respective eligible age cohort that have received at least one dose of influenza vaccine from 1 Oct in school, pharmacy, and general practice.ProportionSt with 95% confidence intervalsData provided is attendances at smoking clinics rather than survey based smoking prevalence\n\n\n\n\n2.4.2 At-risk groups\n\n\n2.4.3 65+",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Indicator definitions</span>"
    ]
  },
  {
    "objectID": "data-summaries.html",
    "href": "data-summaries.html",
    "title": "3  Data summaries",
    "section": "",
    "text": "3.1 AMR\nThe dummy data is per patient sample based.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Data summaries</span>"
    ]
  },
  {
    "objectID": "data-summaries.html#amr",
    "href": "data-summaries.html#amr",
    "title": "3  Data summaries",
    "section": "",
    "text": "3.1.1 E. coli\n\n\n\nTable 3.1: E. coli resistance rates to 3rd generation cephalosporins\n\n\n\n\n\n\n\n\nage_bandresistantsensitivetotalsum_ressum_totmean_ratevaluelowerclupperclconfidencemethod[0,5)8614831520.5460.5710.32590.78695%Wilson[10,15)1831520.54695%Wilson[15,20)123831520.5460.3330.06150.79295%Wilson[20,25)213831520.5460.6670.20770.93995%Wilson[25,30)1831520.54695%Wilson[30,35)336831520.5460.5000.18760.81295%Wilson[35,40)246831520.5460.3330.09680.70095%Wilson[40,45)134831520.5460.2500.04560.69995%Wilson[45,50)123831520.5460.3330.06150.79295%Wilson[50,55)7310831520.5460.7000.39680.89295%Wilson[55,60)9615831520.5460.6000.35750.80295%Wilson[60,65)11920831520.5460.5500.34210.74295%Wilson[65,70)9716831520.5460.5620.33180.76995%Wilson[70,75)5813831520.5460.3850.17710.64595%Wilson[75,80)549831520.5460.5560.26670.81195%Wilson[80,85)10616831520.5460.6250.38640.81595%Wilson[85,90)257831520.5460.2860.08220.64195%Wilson[90,95)527831520.5460.7140.35890.91895%Wilson[95,100)1831520.54695%Wilson\n\n\n\n\n\n\n\n\n\n\nFigure 3.1: e. coli resistance\n\n\n\n\n\n\n\n3.1.2 S.aureus\n\n\n\n\nTable 3.2: MRSA\n\n\n\nage_bandresistantsensitivetotalsum_ressum_totmean_ratevaluelowerclupperclconfidencemethod[0,5)433500.6695%Wilson[10,15)11233500.660.5000.09450.90595%Wilson[15,20)233500.6695%Wilson[20,25)133500.6695%Wilson[25,30)233500.6695%Wilson[30,35)33633500.660.5000.18760.81295%Wilson[35,40)41533500.660.8000.37550.96495%Wilson[40,45)133500.6695%Wilson[45,50)12333500.660.3330.06150.79295%Wilson[50,55)11233500.660.5000.09450.90595%Wilson[55,60)26833500.660.2500.07150.59195%Wilson[60,65)61733500.660.8570.48690.97495%Wilson[65,70)11233500.660.5000.09450.90595%Wilson[70,75)41533500.660.8000.37550.96495%Wilson[75,80)12333500.660.3330.06150.79295%Wilson[80,85)41533500.660.8000.37550.96495%Wilson[85,90)11233500.660.5000.09450.90595%Wilson\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 3.2: Staph aureus resistance rates",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Data summaries</span>"
    ]
  },
  {
    "objectID": "data-summaries.html#flu-vaccination-coverage",
    "href": "data-summaries.html#flu-vaccination-coverage",
    "title": "3  Data summaries",
    "section": "3.2 Flu vaccination coverage",
    "text": "3.2 Flu vaccination coverage\n\n\n\n\nTable 3.3: Counts of flu vaccination by age group, gender and region\n\n\n\nage_groupsgenderAl BahaAl JawfAl QassimAsirHailJazanMakkah Al MukarramahNajranNorthern FrontierRiyadhSharqiyaTabukmadina0-18female38150161343728218136131191400-18male21833620188212223459165+female1493264319162465+male10429513214otherfemale691577531671051,1824821,260102127765othermale917429537120938501536199229443",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Data summaries</span>"
    ]
  },
  {
    "objectID": "data-summaries.html#smoking",
    "href": "data-summaries.html#smoking",
    "title": "3  Data summaries",
    "section": "3.3 Smoking",
    "text": "3.3 Smoking\nCounts of female smoking clinic attendees by directorate for 15+ and 18-44 years\n\n\n\n\nTable 3.4: Counts of female attendees at smoking cessation clinics\n\n\n\nage_1844directorate_namefemale1AlAhsa731Asir91Baha281Bisha61Eastern5511Hafer AlBatin601Hail221Jazan1451Jeddah1,5691Jouf231Madinah2051Makkah5781Najran821Northern Borders41Qassim221Qunfotha131Riyadh1,8301Tabuk2911Taif100\n\n\nage_15directorate_namefemale1AlAhsa931Asir841Baha281Bisha61Eastern5791Hafer AlBatin601Hail221Jazan1581Jeddah1,7881Jouf281Madinah3031Makkah6361Najran851Northern Borders71Qassim481Qunfotha131Qurayyat41Riyadh1,8621Tabuk4361Taif136",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Data summaries</span>"
    ]
  },
  {
    "objectID": "data-summaries.html#injury",
    "href": "data-summaries.html#injury",
    "title": "3  Data summaries",
    "section": "3.4 Injury",
    "text": "3.4 Injury\n\n\n\n\n\n\n\n\nFigure 3.3: Alluvial plot of counts of hospitalisation for injury be age, gender and ICD10 code",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Data summaries</span>"
    ]
  },
  {
    "objectID": "getting-started.html",
    "href": "getting-started.html",
    "title": "4  Getting started",
    "section": "",
    "text": "4.1 Getting started\nThese pages set out the process for loading, cleaning, reshaping and recoding provided datasets for calculating indicator values as a proof of concept, and creating a health profile from those indicators.\nTo facilitate reproducibility the analyses are written in R code in the form of a notebook and R scripts which do much of the pre-processing. The full code is made available as a Github repository at https://github.com/julianflowers/poc. The files can be cloned (downloaded)",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Getting started</span>"
    ]
  },
  {
    "objectID": "getting-started.html#getting-started",
    "href": "getting-started.html#getting-started",
    "title": "4  Getting started",
    "section": "",
    "text": "In RStudio, go to “File &gt; New Project”\nClick on “Version Control:\nCheckout a project from a version control repository”\nClick on “Git:\nClone a project from a repository”\nFill in the info: URL: use HTTPS address\nCreate as a subdirectory of: Browse to where you would like to create this folder\n\n\n4.1.1 The indicators\n4 sets of indicators are used for this PoC:\n\nMethicillin resistant Staph aureus and 3rd generation cephalosporin resistant E.coli - proportion of samples tested which are resistant\nFlu vaccination coverage rates\nSmoking rates in women\nInjury admission rates\n\nFully specifying the indicators\n\nThe proportion of blood samples which grow either Staph aureaus or E. coli, which are tested for antibiotic sensitivity and which are found to be resistant to oxacllin or 3rd generation cephalosporins respectively for time period X to Y, stratified by [area] / [time period] / [age group] / [gender]\nThe proportion of the population which has been vaccinated against flu for the time period X to Y stratified by [area] / [time period] / [age group] / [gender]\nThe rate of smoking in women aged 15+ / 18-44, per 100,000 female population for the time period X to Y stratified by [area] / [time period] / [age group] / [gender]\nThe rate of hospitalisation for injury for the time period X to Y stratified by [area] / [time period] / [age group] / [gender]\n\n\n\n4.1.2 Pre-processing script\nAs a first step we will run a script which does a number of things.\n\nImports the datasets for each indicator\nLoads KSA 2022 census data by age, gender and region1\nMakes variable names consistent\nRecodes region names so that they match the names used in the Census 2022 data\nMaps directorate names (used in smoking data) to region2\nEnsures numeric variables (e.g. age) are converted to numbers\nCreates a set of intermediate data tables\nSaves file of reshaped population data,\n\nThe intermediate tables can be reused for further analysis and generating profiles.\nThe script can be run by typing\n```\n`source(\"~/proof-of-concept/scripts/pre-process.R\")`\n\n```\nat the prompt in the console\nThis generates a set of objects in the R environment\n\n\nCode\nobjects() \n\n\n [1] \"age_names\"                        \"area_names\"                      \n [3] \"census_names\"                     \"cnames\"                          \n [5] \"csv\"                              \"csvs\"                            \n [7] \"data\"                             \"dfs\"                             \n [9] \"dfs_3\"                            \"dfs_4\"                           \n[11] \"dfs1\"                             \"dfs2_agg\"                        \n[13] \"dfs3\"                             \"f_r\"                             \n[15] \"final_poc_data\"                   \"gender_names\"                    \n[17] \"get_coordinates_from_google_maps\" \"m_r\"                             \n[19] \"pop_agg\"                          \"pops\"                            \n[21] \"reg_dir_lu\"                       \"regional_counts\"                 \n[23] \"regional_counts_complete\"         \"RETICULATE_PYTHON\"               \n[25] \"sa_bound\"                         \"sa_shp\"                          \n[27] \"sa_shp_1\"                         \"sc_coords\"                       \n[29] \"sc_dir_links\"                     \"sc_dir_names\"                    \n[31] \"sc_ll\"                            \"sc_ll_sf\"                        \n[33] \"sc_loc\"                           \"scc_dir\"                         \n[35] \"shps\"                             \"smok_1\"                          \n[37] \"smok_agg\"                         \"tmpd\"                            \n[39] \"url\"                              \"xl\"                              \n[41] \"xls\"                             \n\n\nObjects called dfs reflect pre-processing of the original datasets. Objects containing names, contain the different variables used for age, gender and area variables across datasets. Those called sc are used to map locations of smoking clinics as part of recoding directorates to regions for the smoking data (see below).\nThe object regional_counts_complete is a data frame of regional age_band, gender specific counts for each indicator and forms the basis of indicator generation. Note, this includes region-age-band-gender combinations for which there is no data (because these combinations are not present in the original data - although they maybe in the full datasets).\n\n\nCode\nregional_counts_complete |&gt;\n    head() |&gt;\n    flextable::flextable()\n\n\n\n\n\nRegionage_bandsum_f_Smokingsum_f_flusum_f_injurysum_m_Smokingsum_m_flusum_m_injury`Asir[  0,  5)140160260`Asir[  5, 10)0711`Asir[ 10, 15)543552`Asir[ 15, 20)39132,7444`Asir[ 20, 25)7925`Asir[ 25, 30)1762122\n\n\n\nTable 4.1: Region age-band specific counts by gender and indicator\n\n\n\n\n\n\n4.1.3 Mapping health directorates to regions for smoking data\nThe smoking data provided is clinic based data disaggregated at the level of health directorate. There are 20 directorates in KSA, and 13 regions.\nAvailable population data is at regional level, so to generate population denominators for the smoking data I have mapped directorates to regions as follows:\n\nI used a dataset which contained spatial locations of healthcare facilities (smoking cessation clinics) at health directorate level3\nFor each location I extracted spatial coordinates (longitude and latitude)\nI obtained a regional boundary file (shape file) from https://data.humdata.org/dataset/41ce9023-1d21-4549-a485-94316200aba0/resource/99834c81-ad34-415e-91c5-af053d8e55b4/download/sau_capp_adm1_1m_ocha.zip\nI spatially joined the clinic location and boundary files (see\n\n\n\nThis created a lookup table for directorates and regions and enabled the smoking data to be recoded to regions and calculation of rates using the census regional population estimates\n\n\n\nCode\nsc_ll_sf |&gt;\n    ggplot() +\n    geom_sf(data = sa_bound) +\n    geom_sf(aes(colour = name)) \n\n\n\n\n\n\n\n\nFigure 4.1: Location map of smoking clinics mapped to KSA regional boundaries",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Getting started</span>"
    ]
  },
  {
    "objectID": "getting-started.html#footnotes",
    "href": "getting-started.html#footnotes",
    "title": "4  Getting started",
    "section": "",
    "text": "Note. The census data was downloaded from https://tableau.saudicensus.sa/#/views/TA3-PopulationbydetailedAgebyRegionGovernorateNationalityandGenderAR_16850208449070/PopulationbydetailedAgebyRegionGovernorateNationalityandGenderARCSV.csv and variable and region names translated to English using ChatGPT4o↩︎\nThis uses the spatial locations of smoking clinics which include directorate names to map to KSA regional boundaries↩︎\nhttps://www.moh.gov.sa/en/Ministry/Projects/TCP/Pages/default.aspx↩︎",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Getting started</span>"
    ]
  },
  {
    "objectID": "demog.html",
    "href": "demog.html",
    "title": "5  Population demography",
    "section": "",
    "text": "5.1 Population pyramids\n(a) Absolute population\n\n\n\n\n\n\n\n\n\n\n\n(b) Relative population\n\n\n\n\n\n\nFigure 5.1: Population pyramids",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Population demography</span>"
    ]
  },
  {
    "objectID": "amr_poc.html",
    "href": "amr_poc.html",
    "title": "6  AMR walkthrough",
    "section": "",
    "text": "6.1 Introduction\nThis document outlines a stepwise approach to calculating AMR indicators from dummy data kindly supplied by PHA.\nThere are x steps",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>AMR walkthrough</span>"
    ]
  },
  {
    "objectID": "amr_poc.html#introduction",
    "href": "amr_poc.html#introduction",
    "title": "6  AMR walkthrough",
    "section": "",
    "text": "EDA (exploratory data analysis of raw data) - this involves cleaning, visualisation and creation of relevant variables.\nReview of indicator definitions\n\nNumerator\nDenominator\n\nMethod for calculating numerator and denominator values from dataset. The outline uses R code for reproducibility and flexibility.\nCalculating indicator values and uncertainty intervals\nSuggested indicator visualisations (if appropriate).",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>AMR walkthrough</span>"
    ]
  },
  {
    "objectID": "amr_poc.html#amr-indicators",
    "href": "amr_poc.html#amr-indicators",
    "title": "6  AMR walkthrough",
    "section": "6.2 AMR indicators",
    "text": "6.2 AMR indicators\n\n6.2.1 MRSA\n\nPercentage of bloodstream infection due to methicillin-resistant Staphylococcus aureus (MRSA)\n\n\nNumerator: No. of patients with growth of methicillin-resistant S. aureus in tested blood samples\n\n\nDenominator: Total No. of patients with growth of S. aureus in tested blood samples\n\n\n\n6.2.2 E. coli\n\nPercentage of bloodstream infection due to 3rd-generation cephalosporin resistant E. coli\n\n\nNumerator: No. of patients with growth of 3rd-generation cephalosporin resistant E. coli in tested blood samples\n\n\nDenominator: Total No. of patients with growth of E. coli in tested blood samples\n\n\n\n6.2.3 Import data\n\n\nCode\ndf &lt;- amr\n\n\n334 observations",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>AMR walkthrough</span>"
    ]
  },
  {
    "objectID": "amr_poc.html#data-preparation",
    "href": "amr_poc.html#data-preparation",
    "title": "6  AMR walkthrough",
    "section": "6.3 Data preparation",
    "text": "6.3 Data preparation\n\n6.3.1 calculate 5-year age bands\n\n\nCode\namr &lt;- amr[, `:=` (age_band = cut(age_year, breaks = seq(0, 100, 5), right = FALSE))][]\n\nhead(amr)\n\n\n   record_number sample_no patient_mrn   location\n           &lt;num&gt;    &lt;char&gt;      &lt;char&gt;     &lt;char&gt;\n1:             1    ######       ##### Outpatient\n2:            17    ######       #####  Inpatient\n3:            20    ######       #####  Inpatient\n4:            25    ######       #####  Inpatient\n5:            43    ######       ##### Outpatient\n6:            63    ######       ##### Outpatient\n                                                     patient_hospitalized\n                                                                   &lt;char&gt;\n1: Patient had NOT been admitted for more than 2 days in the past 30 days\n2:                       Patient has been hospitalized for 2 days or less\n3:                     Patient has been hospitalized for more than 2 days\n4:                       Patient has been hospitalized for 2 days or less\n5: Patient had NOT been admitted for more than 2 days in the past 30 days\n6: Patient had NOT been admitted for more than 2 days in the past 30 days\n     specific_location age_year community_origin   site first_name second_name\n                &lt;char&gt;    &lt;num&gt;           &lt;char&gt; &lt;char&gt;     &lt;char&gt;      &lt;char&gt;\n1:      Emergency Room        0 Community Origin  Blood       ####       #####\n2: Intensive Care Unit       71 Community Origin  Blood       ####       #####\n3: Intensive Care Unit       44  Hospital Origin  Blood       ####       #####\n4: Intensive Care Unit       67 Community Origin  Blood       ####       #####\n5:      Emergency Room       67 Community Origin  Blood       ####       #####\n6:      Emergency Room       92 Community Origin  Blood       ####       #####\n   family_name national_iqama_id nationality    pathogen_name minocycline\n        &lt;char&gt;            &lt;char&gt;      &lt;char&gt;           &lt;char&gt;      &lt;lgcl&gt;\n1:        ####        ##########       ##### Escherichia coli          NA\n2:        ####        ##########       ##### Escherichia coli          NA\n3:        ####        ##########       ##### Escherichia coli          NA\n4:        ####        ##########       ##### Escherichia coli          NA\n5:        ####        ##########       ##### Escherichia coli          NA\n6:        ####        ##########       ##### Escherichia coli          NA\n   tigecycline ampicillin penicillin_g oxacillin cefoxitin cefotaxime\n        &lt;lgcl&gt;     &lt;char&gt;       &lt;lgcl&gt;    &lt;char&gt;    &lt;char&gt;     &lt;char&gt;\n1:          NA          R           NA      &lt;NA&gt;      &lt;NA&gt;          R\n2:          NA          R           NA      &lt;NA&gt;      &lt;NA&gt;         NA\n3:          NA          S           NA      &lt;NA&gt;      &lt;NA&gt;          S\n4:          NA          R           NA      &lt;NA&gt;      &lt;NA&gt;          R\n5:          NA          R           NA      &lt;NA&gt;      &lt;NA&gt;         NA\n6:          NA          R           NA      &lt;NA&gt;      &lt;NA&gt;         NA\n   ceftazidime ceftriaxone cefixime cefepime doripenem ertapenem imipenem\n        &lt;char&gt;      &lt;char&gt;   &lt;lgcl&gt;   &lt;char&gt;    &lt;char&gt;    &lt;char&gt;   &lt;char&gt;\n1:           R           R       NA        R        NA         S        S\n2:           S           S       NA        S        NA         S        S\n3:           S           S       NA        S        NA         S        S\n4:           R           R       NA        R        NA         S        S\n5:           I           S       NA        S        NA         S        S\n6:           R           R       NA        R         R         S        S\n   meropenem co_trimoxazole azithromycin amikacin gentamicin ciprofloxacin\n      &lt;char&gt;         &lt;char&gt;       &lt;lgcl&gt;   &lt;lgcl&gt;     &lt;lgcl&gt;        &lt;char&gt;\n1:         S              S           NA       NA         NA             S\n2:         S              S           NA       NA         NA             S\n3:         S              S           NA       NA         NA             S\n4:         S              R           NA       NA         NA             S\n5:         S              S           NA       NA         NA             S\n6:         S              R           NA       NA         NA             R\n   levofloxacin colistin spectinomycin age_band\n         &lt;char&gt;   &lt;char&gt;        &lt;lgcl&gt;   &lt;fctr&gt;\n1:            S       NA            NA    [0,5)\n2:            S        S            NA  [70,75)\n3:            S       NA            NA  [40,45)\n4:            S       NA            NA  [65,70)\n5:            S        S            NA  [65,70)\n6:            R        S            NA  [90,95)\n\n\n\n\n6.3.2 remove non-relevant data\nThis step removes identifiers (names, record IDs)\n\n\nCode\namr &lt;- amr |&gt; select(-c(family_name, first_name, sample_no, patient_mrn, second_name, national_iqama_id, nationality))\n\n\n\n\n6.3.3 create per test file (long data)\n\nthis create a per test dataset rather than a per patient sample dataset\n\n\n\nCode\namr_long &lt;- amr |&gt;\n    pivot_longer(names_to = \"antibiotic\", values_to = \"resistance\", cols = minocycline:spectinomycin) |&gt; setDT()\n\n\n\n\n6.3.4 Recode 3rd generation cephalosporins\n\nthis step adds a new variable which labels 3rd generation cephalosporins\n\n\n\nCode\namr_long &lt;- amr_long[, gen_3 := case_when(str_detect(antibiotic, \"cef\") ~ \"3rd-gen\", TRUE ~ \"other\")][]",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>AMR walkthrough</span>"
    ]
  },
  {
    "objectID": "amr_poc.html#data-summarisation-and-description-eda",
    "href": "amr_poc.html#data-summarisation-and-description-eda",
    "title": "6  AMR walkthrough",
    "section": "6.4 Data summarisation and description (EDA)",
    "text": "6.4 Data summarisation and description (EDA)\n\nfirst generate a high level tabular summary\n\n\n\nCode\ngtsummary::tbl_summary(amr)\n\n\n\nrepresent this visually - we’ll use decomposition trees\n\n\n\nCode\namr_freq &lt;- amr_long[pathogen_name == \"Escherichia coli\", .N, by = .(age_band, gen_3, resistance, pathogen_name, community_origin)]\n\ncollapsibleTreeSummary(amr_freq, \n                       c( \"community_origin\", \"gen_3\",\"resistance\"), \n                       root = \"E. coli\", \n                       nodeSize = \"N\", \n                       attribute = \"N\", \n                       fontSize = 16, \n                       collapsed = FALSE)\n\n\n\n\n\n\n\n\nFigure 6.1: Decomposition tree for E. coli",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>AMR walkthrough</span>"
    ]
  },
  {
    "objectID": "amr_poc.html#numerators-and-denominators",
    "href": "amr_poc.html#numerators-and-denominators",
    "title": "6  AMR walkthrough",
    "section": "6.5 Numerators and denominators",
    "text": "6.5 Numerators and denominators\nTo calculate indicators we need to calculate\n\npatients with blood stream infection\nsamples with antibiotic resistance\n\n\n\nCode\namr_long\n\n\nIndex: &lt;pathogen_name&gt;\n      record_number   location\n              &lt;num&gt;     &lt;char&gt;\n   1:             1 Outpatient\n   2:             1 Outpatient\n   3:             1 Outpatient\n   4:             1 Outpatient\n   5:             1 Outpatient\n  ---                         \n7678:          1210  Inpatient\n7679:          1210  Inpatient\n7680:          1210  Inpatient\n7681:          1210  Inpatient\n7682:          1210  Inpatient\n                                                        patient_hospitalized\n                                                                      &lt;char&gt;\n   1: Patient had NOT been admitted for more than 2 days in the past 30 days\n   2: Patient had NOT been admitted for more than 2 days in the past 30 days\n   3: Patient had NOT been admitted for more than 2 days in the past 30 days\n   4: Patient had NOT been admitted for more than 2 days in the past 30 days\n   5: Patient had NOT been admitted for more than 2 days in the past 30 days\n  ---                                                                       \n7678:                     Patient has been hospitalized for more than 2 days\n7679:                     Patient has been hospitalized for more than 2 days\n7680:                     Patient has been hospitalized for more than 2 days\n7681:                     Patient has been hospitalized for more than 2 days\n7682:                     Patient has been hospitalized for more than 2 days\n       specific_location age_year community_origin   site         pathogen_name\n                  &lt;char&gt;    &lt;num&gt;           &lt;char&gt; &lt;char&gt;                &lt;char&gt;\n   1:     Emergency Room        0 Community Origin  Blood      Escherichia coli\n   2:     Emergency Room        0 Community Origin  Blood      Escherichia coli\n   3:     Emergency Room        0 Community Origin  Blood      Escherichia coli\n   4:     Emergency Room        0 Community Origin  Blood      Escherichia coli\n   5:     Emergency Room        0 Community Origin  Blood      Escherichia coli\n  ---                                                                          \n7678: Non Intensive Unit       96  Hospital Origin  Blood Staphylococcus aureus\n7679: Non Intensive Unit       96  Hospital Origin  Blood Staphylococcus aureus\n7680: Non Intensive Unit       96  Hospital Origin  Blood Staphylococcus aureus\n7681: Non Intensive Unit       96  Hospital Origin  Blood Staphylococcus aureus\n7682: Non Intensive Unit       96  Hospital Origin  Blood Staphylococcus aureus\n      age_band    antibiotic resistance  gen_3\n        &lt;fctr&gt;        &lt;char&gt;     &lt;char&gt; &lt;char&gt;\n   1:    [0,5)   minocycline       &lt;NA&gt;  other\n   2:    [0,5)   tigecycline       &lt;NA&gt;  other\n   3:    [0,5)    ampicillin          R  other\n   4:    [0,5)  penicillin_g       &lt;NA&gt;  other\n   5:    [0,5)     oxacillin       &lt;NA&gt;  other\n  ---                                         \n7678: [95,100)    gentamicin       &lt;NA&gt;  other\n7679: [95,100) ciprofloxacin          R  other\n7680: [95,100)  levofloxacin          R  other\n7681: [95,100)      colistin         NA  other\n7682: [95,100) spectinomycin       &lt;NA&gt;  other",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>AMR walkthrough</span>"
    ]
  },
  {
    "objectID": "amr_poc.html#calculate-resistance-rates",
    "href": "amr_poc.html#calculate-resistance-rates",
    "title": "6  AMR walkthrough",
    "section": "6.6 Calculate resistance rates",
    "text": "6.6 Calculate resistance rates\n\ncalculate proportion of tests resistant\ncalculate confidence interval (using Wilson’s score method for proportions via the PHEindicatormethods R package)\n\n\n\nCode\namr_long[pathogen_name == \"Escherichia coli\" & !is.na(resistance), .N, by = .(resistance, gen_3)] |&gt;\n    pivot_wider(names_from = resistance, values_from = N) |&gt;\n    rowwise() |&gt;\n    mutate(total_tests = sum(c_across(R:I), na.rm = TRUE), \n           resistance_rate = R / total_tests) |&gt;\n    flextable::flextable()\n\n\n\n\nTable 6.1: E. coli resistance rates to 3rd generation cephalosporins\n\n\n\ngen_3RNASItotal_testsresistance_rateother30019364671,1460.26178013rd-gen2695619245210.5163148\n\n\n\n\n\n\n6.6.1 by antibiotic\n\n\nCode\noptions(digits = 2)\n\namr_res_ci_sa &lt;- amr_long[pathogen_name == \"Staphylococcus aureus\" & !is.na(resistance), .N, by = .(antibiotic, resistance)] |&gt;\n    pivot_wider(names_from = resistance, values_from = N, values_fill = 0) |&gt;\n    rowwise() |&gt;\n    mutate(total_tests = sum(c_across(S:I), na.rm = TRUE), \n           resistance_rate = R / total_tests)\n\nphe_proportion(amr_res_ci_sa, R, total_tests) |&gt;\n    bind_cols(amr_res_ci_sa) |&gt;\n    ggplot() +\n    geom_point(aes(reorder(antibiotic, value), value)) +\n    geom_linerange(aes(antibiotic, ymin = lowercl, ymax = uppercl)) +\n    coord_flip() +\n    labs(y = \"Staph. aureus resistance rate\", x = \"\") + \n    scale_y_continuous(position = \"right\")\n\n\n\n\n\n\n\n\n\n\n\n6.6.2 by age\n\n\nCode\namr_res_ci_age &lt;- amr_long[pathogen_name == \"Staphylococcus aureus\" & !is.na(resistance), .N, by = .(age_band, resistance)] |&gt;\n    pivot_wider(names_from = resistance, values_from = N, values_fill = 0) |&gt;\n    rowwise() |&gt;\n    mutate(total_tests = sum(c_across(S:I), na.rm = TRUE), \n           resistance_rate = R / total_tests)\n\nphe_proportion(amr_res_ci_age, R, total_tests) |&gt;\n    bind_cols(amr_res_ci_age) |&gt;\n    ggplot() +\n    geom_point(aes(reorder(age_band, value), value)) +\n    geom_linerange(aes(age_band, ymin = lowercl, ymax = uppercl)) +\n    coord_flip() +\n    labs(y = \"Staph. aureus resistance rate\", x = \"\") + \n    scale_y_continuous(position = \"right\")",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>AMR walkthrough</span>"
    ]
  },
  {
    "objectID": "amr_poc.html#e.-coli-1",
    "href": "amr_poc.html#e.-coli-1",
    "title": "6  AMR walkthrough",
    "section": "6.7 E. coli",
    "text": "6.7 E. coli\n\n\nCode\namr_res_ci_ec &lt;- amr_long[str_detect(pathogen_name, \"coli\") & !is.na(resistance), .N, by = .(antibiotic, resistance, gen_3)] |&gt;\n    pivot_wider(names_from = resistance, values_from = N, values_fill = 0) |&gt;\n    rowwise() |&gt;\n    mutate(total_tests = sum(c_across(R:I), na.rm = TRUE), \n           resistance_rate = R / total_tests)\n\nphe_proportion(amr_res_ci_ec, R, total_tests) |&gt;\n    bind_cols(amr_res_ci_ec) |&gt;\n    ggplot() +\n    geom_point(aes(reorder(antibiotic, value), value, colour = gen_3)) +\n    geom_linerange(aes(antibiotic, ymin = lowercl, ymax = uppercl)) +\n    coord_flip() +\n    labs(y = \"E. coli resistance rate\", x = \"\") + scale_y_continuous(position = \"right\")",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>AMR walkthrough</span>"
    ]
  },
  {
    "objectID": "smoking-poc.html",
    "href": "smoking-poc.html",
    "title": "7  Smoking",
    "section": "",
    "text": "7.1 Workflow\nflowchart TD\nA[Data] --&gt; B[population data]\nA --&gt; C[smoking data]\nC --&gt; D[[reclassify directorate names to regions]] --&gt; E[[calculate age bands]] --&gt; F[[calculate smoking counts]]\nB --&gt; G[[calculate age bands]] --&gt; H[[calculate population counts]]\nH --&gt; I[[join datasets]]\nF --&gt; I\nI --&gt; J[calculate rates and ci]\n\n\n\n\n\nFigure 7.1: Proposed workflow for calculating smoking rates",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Smoking</span>"
    ]
  },
  {
    "objectID": "smoking-poc.html#workflow",
    "href": "smoking-poc.html#workflow",
    "title": "7  Smoking",
    "section": "",
    "text": "7.1.1 Load census population and create age bands\n\n\nCode\n## create age band\n\npops &lt;- setDT(pops)[, `:=` (`18-44`  = dplyr::between(age, 18, 44), `15+` = age &gt;= 15, `80+` = age &gt;= 80, age_band = cut(age, seq(0, 110, 5), right = FALSE))][]\n\npop_age &lt;- pops[, .(n = .N, sumpops = sum(Population, na.rm = TRUE)), by = .(Region, age_band,  Gender)][order(age_band)]\n\npop1844F &lt;- pops[, .(n = .N, sumpops = sum(Population, na.rm = TRUE)), by = .(Region, `18-44`,  Gender)][`18-44` == \"TRUE\" & Gender == \"Female\",]\n\npop15F &lt;- pops[, .(n = .N, sumpops = sum(Population, na.rm = TRUE)), by = .(Region, `15+`,  Gender)][`15+` == \"TRUE\" & Gender == \"Female\",]\n\n\n\n\n7.1.2 Load smoking data and calculate age bands\nNote: it is not clear if the dummy data is a random sample of clinic attendance data.\n\n\nCode\nsmok_age &lt;- smoking[, `:=` (`18-44`  = dplyr::between(age, 18, 44), `15+` = age &gt;= 15, `80+` = age &gt;= 80, age_band = cut(age, seq(0, 110, 5), right = FALSE))][]\n\nsmok_age_bands &lt;- smok_age[, .(n = .N, smokers = sum(n, na.rm = TRUE)), by = .(Region, age_band,  Gender)][order(age_band)]\n\nsmok1844F &lt;- smok_age[, .(n = .N, smokers = sum(n, na.rm = TRUE)), by = .(Region, `18-44`,  Gender)][`18-44` == \"TRUE\" & Gender == \"female\",]\n\nsmok15F &lt;- smok_age[, .(n = .N, smokers = sum(n, na.rm = TRUE)), by = .(Region, `15+`,  Gender)][`15+` == \"TRUE\" & Gender == \"female\",]\n\n\n\n\n7.1.3 Join datasets and calculate rates\nThis step uses Byar’s method for confidence interval for rates\n\n\nCode\nsmok_rates &lt;- pop1844F |&gt;\n    left_join(smok1844F, by = \"Region\") |&gt; \n    phe_rate(x = smokers, n = sumpops) \n\nsmok_rates |&gt;\n    dplyr::select(Region, smokers, population = sumpops, value, lowercl, uppercl) |&gt;\n    flextable::flextable()\n\n\n\n\nRegionsmokerspopulationvaluelowercluppercl'Asir366,324Al Bahah2861,96945.18388230.01772965.30573Al Hudud ash Shamaliyah470,1495.7021481.55364314.59976Al Jawf23103,53622.21449514.07758733.33412Al Madinah al Munawwarah387,944Al Mintaqah ash Sharqiyah877,403Al Qasim249,081Ar Riyadh1,609,493Ha'il22136,64216.10046710.08657124.37741Jazan267,342Makkah al Mukarramah1,507,301Najran82105,91577.42057361.57287696.10050Tabuk291163,453178.032829158.162585199.70848\n\n\nFigure 7.2: Smoking clinic attendance rates (18-44)\n\n\n\n\nCode\nsmok_rates |&gt;\n    write_csv(\"data/smok_rates.csv\")\n   \nsmok_rates |&gt;\n    ggplot() +\n    geom_col(aes(reorder(Region, value), value)) +\n    geom_linerange(aes(x = Region, ymin = lowercl, ymax = uppercl)) +\n    coord_flip() +\n    labs(x = \" \",\n         y = \"Rate per 100.000\")\n\n\n\n\n\n\n\n\nFigure 7.3: Smoking clinic attendance rates (18-44)\n\n\n\n\n\n\n\n7.1.4 Age-specific attendance rates\n\n\nCode\nsmok_age_agg &lt;- smok_age_bands[, .(tot_smokers = sum(smokers)), by = .(age_band, Gender)][]\n\noptions(scipen = 999, digitds = 2)\n\n## m:f as smoking ratios\n\nsmok_rates_gender &lt;- pop_age |&gt;\n    dplyr::select(-Region) |&gt;\n    mutate(Gender = recode(Gender, \"Female\" = \"female\", \"Male\" = \"male\")) |&gt;\n    left_join(smok_age_agg, by = c(\"age_band\", \"Gender\")) |&gt;\n    group_by(age_band, Gender) |&gt;\n    reframe(nat_smok = sum(tot_smokers, na.rm = TRUE), \n           nat_pop = sum(sumpops)) |&gt;\n    phe_rate(x = nat_smok, n = nat_pop) |&gt; \n    mutate(value = ifelse(Gender == \"female\", -value, value)) |&gt;\n    ggplot() +\n    geom_col(aes(age_band, value, fill = Gender)) +\n    coord_flip() +\n    scale_fill_manual(values = c(\"blue\", \"red\")) +\n    labs(x = \"\",  y = \"Attendance rate per 100000\")\n\nsmok_rates_gender    \n\n\n\n\n\n\n\n\n\nCode\nsmok_gender_ratio &lt;- pop_age |&gt;\n    dplyr::select(-Region) |&gt;\n    mutate(Gender = recode(Gender, \"Female\" = \"female\", \"Male\" = \"male\")) |&gt;\n    left_join(smok_age_agg, by = c(\"age_band\", \"Gender\")) |&gt;\n    group_by(age_band, Gender) |&gt;\n    reframe(nat_smok = sum(tot_smokers, na.rm = TRUE), \n           nat_pop = sum(sumpops)) |&gt;\n    phe_rate(x = nat_smok, n = nat_pop) |&gt;\n    slice(7:36) |&gt;\n    group_by(age_band) |&gt;\n    reframe(ratio = value[2] / value[1]) |&gt;\n    mutate(mean_ratio = mean(ratio))\n\n\nThe relative attendance rate for males is 17.32 times that of females. Smoking clinic attendance rates could be used as a proxy for population smoking rates if the relationship between attendance and prevalenceis known . For example, survey data suggests that KSA male smoking rates are around 20% which implies a female smoking rate based of 1.15%.",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Smoking</span>"
    ]
  },
  {
    "objectID": "flu.html",
    "href": "flu.html",
    "title": "8  Flu vaccination coverage",
    "section": "",
    "text": "8.1 Workflow\nflowchart TD\nA[Data] --&gt; B[population data]\nA --&gt; C[vaccination data]\nC --&gt; D[[recode region names]] --&gt; E[[calculate age bands]] --&gt; F[[calculate vaccination counts]]\nB --&gt; G[[calculate age bands]] --&gt; H[[calculate population counts]]\nF --&gt; I[[join datasets]]\nH --&gt; I\nI --&gt; J[calculate rates and ci]\n\n\n\n\n\nFigure 8.1: Proposed workflow for calculating flu vaccination coverage",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Flu vaccination coverage</span>"
    ]
  },
  {
    "objectID": "flu.html#clean-data",
    "href": "flu.html#clean-data",
    "title": "8  Flu vaccination coverage",
    "section": "8.2 Clean data",
    "text": "8.2 Clean data\nRecode region names Add new age bands\n\n\nCode\nflu_data &lt;- flu_data |&gt;\n    mutate(paed = dplyr::between(age, 0, 18), \n           older = age &gt;= 65) |&gt;\n    mutate(Region = case_when(str_detect(Region, \"Baha\") ~ \"Al Bahah\", \n                              str_detect(Region, \"Qu?assim\") ~ \"Al Qasim\",\n                              str_detect(Region, \"Asir\") ~ \"`Asir\",\n                              str_detect(Region, \"Hail\") ~ \"Ha'il\",\n                              str_detect(Region, \"[Mm]adin\") ~ \"Al Madinah al Munawwarah\",\n                              str_detect(Region, \"Jizan\") ~ \"Jazan\",\n                              str_detect(Region, \"Makka\") ~ \"Makkah al Mukarramah\",\n                              str_detect(Region, \"Sharqiya\" ) ~ \"Al Mintaqah ash Sharqiyah\",\n                              str_detect(Region, \"Northern Frontier\") ~ \"Al Hudud ash Shamaliyah\",\n                              str_detect(Region, \"Riyad\") ~ \"Ar Riyadh\",\n                              TRUE ~ Region ))",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Flu vaccination coverage</span>"
    ]
  },
  {
    "objectID": "flu.html#calculate-regional-numerators-and-denominators",
    "href": "flu.html#calculate-regional-numerators-and-denominators",
    "title": "8  Flu vaccination coverage",
    "section": "8.3 Calculate regional numerators and denominators",
    "text": "8.3 Calculate regional numerators and denominators\n\nCalculate region-by-gender populations for 0-18 and 65+\nCalculate region-by-gender vaccinations for 0-18 and 65+\n\n\n\nCode\npop_paed &lt;- popns |&gt;\n    group_by(Region, Gender, paed) |&gt;\n    reframe(pop = sum(Population)) |&gt;\n    filter(paed == \"TRUE\") |&gt;\n    mutate(Gender = recode(Gender, \"Female\" = \"female\", \"Male\" = \"male\"), \n           Region = recode(Region, \"`Asir\" = \"'Asir\"))\n\npop_older &lt;-popns |&gt;\n    group_by(Region, Gender, older) |&gt;\n    reframe(pop = sum(Population)) |&gt;\n    filter(older == \"TRUE\") |&gt;\n    mutate(Gender = recode(Gender, \"Female\" = \"female\", \"Male\" = \"male\"), \n           Region = recode(Region, \"`Asir\" = \"'Asir\"))\n\n## fills all region-gender categories and remove unknown\npaed_flu &lt;- flu_data |&gt;\n    filter(paed == \"TRUE\") |&gt;\n    count(Region, Gender) |&gt;\n    complete(Region, Gender) |&gt;\n    filter(Gender != \"unknown\") |&gt;\n    mutate( Region = recode(Region, \"`Asir\" = \"'Asir\"))\n\nolder_flu &lt;- flu_data |&gt;\n    filter(older == \"TRUE\") |&gt;\n    count(Region, Gender) |&gt;\n    complete(Region, Gender) |&gt;\n    filter(Gender != \"unknown\") |&gt;\n    mutate( Region = recode(Region, \"`Asir\" = \"'Asir\"))",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Flu vaccination coverage</span>"
    ]
  },
  {
    "objectID": "flu.html#join-populations-and-vaccination-data",
    "href": "flu.html#join-populations-and-vaccination-data",
    "title": "8  Flu vaccination coverage",
    "section": "8.4 Join populations and vaccination data",
    "text": "8.4 Join populations and vaccination data\n\n\nCode\npaed_nd &lt;- paed_flu |&gt;\n  left_join(pop_paed) |&gt;\n  select(-paed)\n\nolder_nd &lt;- older_flu |&gt;\n  left_join(pop_older) |&gt;\n  select(-older)",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Flu vaccination coverage</span>"
    ]
  },
  {
    "objectID": "flu.html#calculate-coverage-by-age-group",
    "href": "flu.html#calculate-coverage-by-age-group",
    "title": "8  Flu vaccination coverage",
    "section": "8.5 Calculate coverage by age group",
    "text": "8.5 Calculate coverage by age group\n\n\nCode\npaed_coverage &lt;- paed_nd |&gt;\n  phe_proportion(x = n, n = pop) |&gt;\n  mutate(age = \"0-18\")    \n\nolder_coverage &lt;- older_nd |&gt;\n  phe_proportion(x = n, n = pop) |&gt;\n  mutate(age = \"65+\")\n\nbind_rows(paed_coverage, older_coverage) |&gt;\n    write_csv(\"data/flu_coverage.csv\")",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Flu vaccination coverage</span>"
    ]
  },
  {
    "objectID": "flu.html#tabulate",
    "href": "flu.html#tabulate",
    "title": "8  Flu vaccination coverage",
    "section": "8.6 Tabulate",
    "text": "8.6 Tabulate\n\n\nCode\noptions(digits = 3)\n\npaed_coverage |&gt;\n  select(-c(statistic, method)) |&gt;\n  head() |&gt;\n  flextable()\nolder_coverage |&gt;\n  select(-c(statistic, method)) |&gt;\n  head() |&gt;\n  flextable()\n\n\n\n\nTable 8.1: Flu vaccination coverage\n\n\n\nRegionGendernpopvaluelowerclupperclconfidenceage'Asirfemale161335,0110.00048060.000411870.000560795%0-18'Asirmale33347,7510.00009490.000067570.000133395%0-18Al Bahahfemale3857,2300.00066400.000483820.000911295%0-18Al Bahahmale259,0770.00003390.000009280.000123495%0-18Al Hudud ash Shamaliyahfemale170,3500.00001420.000002510.000080595%0-18Al Hudud ash Shamaliyahmale73,06895%0-18\n\n\nRegionGendernpopvaluelowerclupperclconfidenceage'Asirfemale4932,2240.0015210.00115050.00201095%65+'Asirmale1036,2880.0002760.00014970.00050795%65+Al Bahahfemale17,7910.0001280.00002270.00072795%65+Al Bahahmale6,75295%65+Al Madinah al Munawwarahfemale2431,0990.0007720.00051870.00114895%65+Al Madinah al Munawwarahmale1431,2310.0004480.00026710.00075295%65+",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Flu vaccination coverage</span>"
    ]
  },
  {
    "objectID": "flu.html#visualise",
    "href": "flu.html#visualise",
    "title": "8  Flu vaccination coverage",
    "section": "8.7 Visualise",
    "text": "8.7 Visualise\n\n\nCode\npaed_coverage |&gt;\n  ggplot() +\n  geom_col(aes(Region, value, fill = Gender)) +\n  geom_linerange(aes(Region, ymin = lowercl, ymax = uppercl)) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1) ) +\n  facet_wrap(~ Gender) +\n  scale_fill_manual(values = c(\"blue\", \"red\"))\n\n\nolder_coverage |&gt;\n  ggplot() +\n  geom_col(aes(Region, value, fill = Gender)) +\n  geom_linerange(aes(Region, ymin = lowercl, ymax = uppercl)) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1) ) +\n  facet_wrap(~ Gender) +\n  scale_fill_manual(values = c(\"blue\", \"red\")) \n\n\n\n\n\n\n\n\n\n\n\n(a) Paediatric coverage\n\n\n\n\n\n\n\n\n\n\n\n(b) 65+ coverage\n\n\n\n\n\n\nFigure 8.2: Flu vaccination coverage",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Flu vaccination coverage</span>"
    ]
  },
  {
    "objectID": "injury.html",
    "href": "injury.html",
    "title": "9  Injury",
    "section": "",
    "text": "9.1 Injury\nCode\noptions(digits = 2)\nsummary(injury)\n\n\n  DateOfBirth                          code            diagnosis        \n Min.   :1939-08-16 00:00:00.000   Length:10380       Length:10380      \n 1st Qu.:1970-10-10 00:00:00.000   Class :character   Class :character  \n Median :1985-11-10 00:00:00.000   Mode  :character   Mode  :character  \n Mean   :1984-01-01 12:27:30.296                                        \n 3rd Qu.:1996-07-05 00:00:00.000                                        \n Max.   :2022-01-30 00:00:00.000                                        \n NA's   :773                                                            \n    Gender             Region         \n Length:10380       Length:10380      \n Class :character   Class :character  \n Mode  :character   Mode  :character  \n                                      \n                                      \n                                      \n                                      \n\n\nCode\nobs &lt;- nrow(injury)\nna_dob &lt;- injury[is.na(DateOfBirth), ]\nna_dob_n &lt;- nrow(na_dob)\nOverall there are 10380 records, of which 773 (7.45% ) have missing dates of of birth.\nCode\ninjury[, .N, by = .(diagnosis, code, Gender, Region )]\n\n\n                                                                                        diagnosis\n                                                                                           &lt;char&gt;\n 1:                                                             Crushing injury of ankle and foot\n 2:                                                                             Fracture of femur\n 3:                                                                 Superficial injury of forearm\n 4:                Dislocation, sprain and strain of joints and ligaments at ankle and foot level\n 5:                                                                           Intracranial injury\n 6:                                                                           Fracture of forearm\n 7:                                                                           Fracture of forearm\n 8:                               Certain early complications of trauma, not elsewhere classified\n 9:                                                             Injury of unspecified body region\n10:                                                                              Fracture of neck\n11:                                                            Fracture of skull and facial bones\n12:                                                                          Open wound of thorax\n13:                                                          Open wound of shoulder and upper arm\n14:                                                                             Fracture of femur\n15:                                                                           Fracture of forearm\n16:                                                                             Fracture of femur\n17:                               Certain early complications of trauma, not elsewhere classified\n18:                                                Fracture of rib(s), sternum and thoracic spine\n19:                                                                             Fracture of femur\n20:                                                                  Burn body region unspecified\n21:                                                        Fracture of lower leg, including ankle\n22:                                                                Fracture of foot, except ankle\n23:                                                 Toxic effect of contact with venomous animals\n24:                                                        Other and unspecified injuries of neck\n25:                                                        Fracture of lower leg, including ankle\n26:                          Dislocation, sprain and strain of joints and ligaments at neck level\n27:                                 Burns classified according to extent of body surface involved\n28:                                                       Other specified complications of trauma\n29:                                                        Fracture of lower leg, including ankle\n30:                                        Burn of shoulder and upper limb, except wrist and hand\n31:                                                            Fracture of skull and facial bones\n32:                                        Burn of shoulder and upper limb, except wrist and hand\n33:                                                                            Open wound of head\n34: Poisoning by diuretics and other and unspecified drugs, medicaments and biological substances\n35:                                                        Fracture of lower leg, including ankle\n36:                                                                  Sequelae of injuries of head\n37: Poisoning by diuretics and other and unspecified drugs, medicaments and biological substances\n38:                                                                        Burn of wrist and hand\n39:                                                            Fracture of shoulder and upper arm\n40:                                 Burns classified according to extent of body surface involved\n41:                                                            Fracture of skull and facial bones\n42:                                                          Superficial injury of wrist and hand\n43:                                                            Fracture of shoulder and upper arm\n44:                                                                  Burn body region unspecified\n45:                                           Injury of muscle and tendon at wrist and hand level\n46:                                                                           Intracranial injury\n47:                                                              Foreign body in alimentary tract\n48:                                                       Other specified complications of trauma\n49:                                                        Fracture of lower leg, including ankle\n50:                                         Complications of procedures, not elsewhere classified\n51:                                                            Fracture of shoulder and upper arm\n52:                                                                           Intracranial injury\n53:                                                             Crushing injury of ankle and foot\n54:                                                                             Fracture of femur\n55:                                                          Fracture of spine, level unspecified\n56:                Dislocation, sprain and strain of joints and ligaments at ankle and foot level\n57:                                                           Fracture of lumbar spine and pelvis\n58:                Dislocation, sprain and strain of joints and ligaments at wrist and hand level\n59:                                          Injury of other and unspecified intrathoracic organs\n60:                                                                  Burn body region unspecified\n61:                                                           Superficial injury of hip and thigh\n62:                                             Crushing injuries involving multiple body regions\n63:                                 Burns classified according to extent of body surface involved\n64:                                                                            Open wound of head\n65:                      Other injuries involving multiple body regions, not elsewhere classified\n66:                                                                           Fracture of forearm\n67:                                                                           Intracranial injury\n68:                                                                         Burn of head and neck\n69:                                                             Crushing injury of wrist and hand\n70:                                                 Toxic effect of contact with venomous animals\n71:                                                        Other and unspecified injuries of neck\n72:                                                       Other specified complications of trauma\n73:                                                                            Open wound of head\n74: Poisoning by diuretics and other and unspecified drugs, medicaments and biological substances\n75:                                                                        Burn of wrist and hand\n76:                                                            Fracture of skull and facial bones\n77:                                                        Fracture of lower leg, including ankle\n78:                                                          Fracture of spine, level unspecified\n79:                                                Fracture of rib(s), sternum and thoracic spine\n80:                                                            Fracture of skull and facial bones\n81:                                                                           Intracranial injury\n82:                                                           Fracture of lumbar spine and pelvis\n83:                               Certain early complications of trauma, not elsewhere classified\n                                                                                        diagnosis\n      code Gender            Region     N\n    &lt;char&gt; &lt;char&gt;            &lt;char&gt; &lt;int&gt;\n 1:    S97   Male            Makkah   140\n 2:    S72 Female            Makkah   240\n 3:    S50   Male            Makkah   300\n 4:    S93   Male            Riyadh   160\n 5:    S06   Male            Makkah   400\n 6:    S52   Male           Madinah   258\n 7:    S52 Female            Makkah   360\n 8:    T79   Male            Makkah   160\n 9:    T14   Male           Madinah   160\n10:    S12   Male            Riyadh   160\n11:    S02   Male            Riyadh   160\n12:    S21   Male            Riyadh   160\n13:    S41   Male            Riyadh   160\n14:    S72   Male           Madinah   225\n15:    S52   Male            Makkah   180\n16:    S72   Male            Makkah   180\n17:    T79   Male           Madinah    59\n18:    S22   Male           Madinah    66\n19:    S72 Female            Riyadh   600\n20:    T30   Male           Madinah   500\n21:    S82   Male           Madinah   167\n22:    S92   Male            Makkah   160\n23:    T63   Male           Madinah    58\n24:    S19   Male           Madinah    58\n25:    S82   Male            Makkah   160\n26:    S13   Male            Riyadh   280\n27:    T31   Male            Riyadh   280\n28:    T89   Male            Riyadh   100\n29:    S82 Female            Riyadh   280\n30:    T22   Male            Riyadh   280\n31:    S02   Male            Makkah   187\n32:    T22   Male            Makkah   160\n33:    S01   Male Northern Frontier    58\n34:    T50   Male Northern Frontier    57\n35:    S82   Male          Sharqiya   160\n36:    T90 Female            Makkah   160\n37:    T50 Female           Madinah   160\n38:    T23   Male           Madinah    58\n39:    S42   Male            Najran   160\n40:    T31   Male            Makkah   160\n41:    S02   Male           Al Baha    58\n42:    S60 Female           Al Jawf   160\n43:    S42 Female         Al Qassim   160\n44:    T30 Female              Asir   160\n45:    S66   Male              Hail   160\n46:    S06   Male             Jazan   140\n47:    T18   Male           Madinah    20\n48:    T89   Male            Makkah    20\n49:    S82 Female            Makkah    60\n50:    T81   Male           Madinah    20\n51:    S42 Female            Makkah    20\n52:    S06 Female            Makkah    20\n53:    S97   Male           Madinah    20\n54:    S72 Female           Madinah   135\n55:    T08   Male           Madinah     7\n56:    S93   Male            Makkah    20\n57:    S32   Male            Makkah    27\n58:    S63 Female            Makkah    20\n59:    S27   Male            Makkah    20\n60:    T30   Male            Makkah    20\n61:    S70   Male            Makkah    20\n62:    T04   Male            Makkah    20\n63:    T31   Male           Madinah    20\n64:    S01   Male            Makkah    20\n65:    T06   Male            Makkah    20\n66:    S52 Female           Madinah   122\n67:    S06   Male           Madinah     7\n68:    T20   Male            Makkah    20\n69:    S67   Male            Makkah    20\n70:    T63 Female           Madinah   102\n71:    S19 Female           Madinah   102\n72:    T89 Female            Riyadh   180\n73:    S01 Female Northern Frontier   102\n74:    T50 Female Northern Frontier   103\n75:    T23 Female           Madinah   102\n76:    S02 Female           Al Baha   102\n77:    S82 Female           Madinah    13\n78:    T08 Female           Madinah    13\n79:    S22 Female           Madinah   114\n80:    S02 Female            Makkah    13\n81:    S06 Female           Madinah    13\n82:    S32 Female            Makkah    13\n83:    T79 Female           Madinah   101\n      code Gender            Region     N\nCode\nunique(injury$Region)\n\n\n [1] \"Makkah\"            \"Riyadh\"            \"Madinah\"          \n [4] \"Northern Frontier\" \"Sharqiya\"          \"Najran\"           \n [7] \"Al Baha\"           \"Al Jawf\"           \"Al Qassim\"        \n[10] \"Asir\"              \"Hail\"              \"Jazan\"\nThe data contains values for 12 of the 13 regions.\nCode\n## exclude missing DoB\ninjury_dob &lt;-  injury[!is.na(DateOfBirth),]\n\ninjury_dob &lt;- injury_dob[!is.na(DateOfBirth), age := .(as.POSIXct(ymd(\"2023-06-01\")) - DateOfBirth)][, age_year := floor(as.numeric(age) / 365)][, age_band := cut(age_year, seq(0, 120, 5))][]",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Injury</span>"
    ]
  },
  {
    "objectID": "injury.html#aggregate-injury-data",
    "href": "injury.html#aggregate-injury-data",
    "title": "9  Injury",
    "section": "9.2 Aggregate injury data",
    "text": "9.2 Aggregate injury data\n\n\nCode\ninjury_dob[, .N, by = .(Region, diagnosis, code, age_band, Gender)][order(Region)] |&gt;\n    pivot_wider(names_from = Region, values_from = N) |&gt;\n    arrange(age_band, code, Gender) |&gt;\n    flextable::flextable()\n\n\ndiagnosiscodeage_bandGenderAl BahaAl JawfAl QassimAsirHailJazanMadinahMakkahNajranNorthern FrontierRiyadhSharqiyaCrushing injury of wrist and handS67(0,5]Male20Burn body region unspecifiedT30(0,5]Female160Burn body region unspecifiedT30(0,5]Male32020Fracture of skull and facial bonesS02(10,15]Male20160Fracture of forearmS52(10,15]Male199Superficial injury of wrist and handS60(10,15]Female160Fracture of femurS72(10,15]Female9Fracture of lower leg, including ankleS82(10,15]Male160Crushing injury of ankle and footS97(10,15]Male20Fracture of spine, level unspecifiedT08(10,15]Female1Burn of wrist and handT23(10,15]Female8Burn body region unspecifiedT30(10,15]Male160Other specified complications of traumaT89(10,15]Female8Fracture of rib(s), sternum and thoracic spineS22(15,20]Female1Crushing injuries involving multiple body regionsT04(15,20]Male19Open wound of headS01(20,25]Female17Fracture of skull and facial bonesS02(20,25]Female191Intracranial injuryS06(20,25]Female1Other and unspecified injuries of neckS19(20,25]Female18Fracture of rib(s), sternum and thoracic spineS22(20,25]Female19Fracture of lumbar spine and pelvisS32(20,25]Female1Fracture of forearmS52(20,25]Female38Fracture of forearmS52(20,25]Male1Fracture of femurS72(20,25]Female19Fracture of lower leg, including ankleS82(20,25]Female220Crushing injuries involving multiple body regionsT04(20,25]Male1Fracture of spine, level unspecifiedT08(20,25]Female1Injury of unspecified body regionT14(20,25]Male160Foreign body in alimentary tractT18(20,25]Male20Burn of wrist and handT23(20,25]Female19Burns classified according to extent of body surface involvedT31(20,25]Male280Poisoning by diuretics and other and unspecified drugs, medicaments and biological substancesT50(20,25]Female16018Toxic effect of contact with venomous animalsT63(20,25]Female19Certain early complications of trauma, not elsewhere classifiedT79(20,25]Female18Other specified complications of traumaT89(20,25]Female32Other specified complications of traumaT89(20,25]Male20Open wound of headS01(25,30]Female13Open wound of headS01(25,30]Male20Fracture of skull and facial bonesS02(25,30]Female122Intracranial injuryS06(25,30]Female2Intracranial injuryS06(25,30]Male160Fracture of neckS12(25,30]Male160Other and unspecified injuries of neckS19(25,30]Female12Open wound of thoraxS21(25,30]Male160Fracture of rib(s), sternum and thoracic spineS22(25,30]Female14Fracture of lumbar spine and pelvisS32(25,30]Female2Fracture of shoulder and upper armS42(25,30]Male160Superficial injury of forearmS50(25,30]Male160Fracture of forearmS52(25,30]Female12Fracture of femurS72(25,30]Female6Fracture of lower leg, including ankleS82(25,30]Female2Fracture of lower leg, including ankleS82(25,30]Male160Fracture of spine, level unspecifiedT08(25,30]Female2Burn of head and neckT20(25,30]Male20Burn of wrist and handT23(25,30]Female4Poisoning by diuretics and other and unspecified drugs, medicaments and biological substancesT50(25,30]Female12Toxic effect of contact with venomous animalsT63(25,30]Female12Certain early complications of trauma, not elsewhere classifiedT79(25,30]Female12Other specified complications of traumaT89(25,30]Female14Open wound of headS01(30,35]Female11Open wound of headS01(30,35]Male8Fracture of skull and facial bonesS02(30,35]Female181Fracture of skull and facial bonesS02(30,35]Male101Intracranial injuryS06(30,35]Female1Intracranial injuryS06(30,35]Male117Other and unspecified injuries of neckS19(30,35]Female11Other and unspecified injuries of neckS19(30,35]Male8Fracture of rib(s), sternum and thoracic spineS22(30,35]Female13Fracture of rib(s), sternum and thoracic spineS22(30,35]Male9Fracture of lumbar spine and pelvisS32(30,35]Female1Fracture of lumbar spine and pelvisS32(30,35]Male1Open wound of shoulder and upper armS41(30,35]Male160Superficial injury of forearmS50(30,35]Male140Fracture of forearmS52(30,35]Female11Fracture of forearmS52(30,35]Male8Fracture of femurS72(30,35]Female12Fracture of femurS72(30,35]Male9Fracture of lower leg, including ankleS82(30,35]Female2Fracture of lower leg, including ankleS82(30,35]Male1Fracture of foot, except ankleS92(30,35]Male2Fracture of spine, level unspecifiedT08(30,35]Female2Fracture of spine, level unspecifiedT08(30,35]Male1Burn of shoulder and upper limb, except wrist and handT22(30,35]Male280Burn of wrist and handT23(30,35]Female10Burn of wrist and handT23(30,35]Male9Burns classified according to extent of body surface involvedT31(30,35]Male2160Poisoning by diuretics and other and unspecified drugs, medicaments and biological substancesT50(30,35]Female11Poisoning by diuretics and other and unspecified drugs, medicaments and biological substancesT50(30,35]Male8Toxic effect of contact with venomous animalsT63(30,35]Female11Toxic effect of contact with venomous animalsT63(30,35]Male8Certain early complications of trauma, not elsewhere classifiedT79(30,35]Female11Certain early complications of trauma, not elsewhere classifiedT79(30,35]Male8Other specified complications of traumaT89(30,35]Female26Other specified complications of traumaT89(30,35]Male14Intracranial injuryS06(35,40]Male140Dislocation, sprain and strain of joints and ligaments at neck levelS13(35,40]Male280Fracture of lumbar spine and pelvisS32(35,40]Female4Fracture of lumbar spine and pelvisS32(35,40]Male21Fracture of forearmS52(35,40]Male180Injury of muscle and tendon at wrist and hand levelS66(35,40]Male160Fracture of femurS72(35,40]Male19Fracture of lower leg, including ankleS82(35,40]Female20Burn of shoulder and upper limb, except wrist and handT22(35,40]Male160Open wound of headS01(40,45]Female8Open wound of headS01(40,45]Male2Fracture of skull and facial bonesS02(40,45]Female15Fracture of skull and facial bonesS02(40,45]Male21Intracranial injuryS06(40,45]Female5Intracranial injuryS06(40,45]Male1142Other and unspecified injuries of neckS19(40,45]Female8Other and unspecified injuries of neckS19(40,45]Male1Fracture of rib(s), sternum and thoracic spineS22(40,45]Female41Fracture of rib(s), sternum and thoracic spineS22(40,45]Male11Fracture of lumbar spine and pelvisS32(40,45]Female1Fracture of forearmS52(40,45]Female39Fracture of forearmS52(40,45]Male9Dislocation, sprain and strain of joints and ligaments at wrist and hand levelS63(40,45]Female19Superficial injury of hip and thighS70(40,45]Male19Fracture of femurS72(40,45]Female11Fracture of femurS72(40,45]Male4Fracture of lower leg, including ankleS82(40,45]Male1Crushing injury of ankle and footS97(40,45]Male139Fracture of spine, level unspecifiedT08(40,45]Female3Fracture of spine, level unspecifiedT08(40,45]Male1Burn of wrist and handT23(40,45]Female8Burn of wrist and handT23(40,45]Male3Burn body region unspecifiedT30(40,45]Male19Burns classified according to extent of body surface involvedT31(40,45]Male17Poisoning by diuretics and other and unspecified drugs, medicaments and biological substancesT50(40,45]Female8Poisoning by diuretics and other and unspecified drugs, medicaments and biological substancesT50(40,45]Male3Toxic effect of contact with venomous animalsT63(40,45]Female7Toxic effect of contact with venomous animalsT63(40,45]Male1Certain early complications of trauma, not elsewhere classifiedT79(40,45]Female38Certain early complications of trauma, not elsewhere classifiedT79(40,45]Male10Other specified complications of traumaT89(40,45]Female8Other specified complications of traumaT89(40,45]Male1Open wound of headS01(45,50]Female33Open wound of headS01(45,50]Male7Fracture of skull and facial bonesS02(45,50]Female331Fracture of skull and facial bonesS02(45,50]Male6Intracranial injuryS06(45,50]Female1Intracranial injuryS06(45,50]Male41Other and unspecified injuries of neckS19(45,50]Female33Other and unspecified injuries of neckS19(45,50]Male8Fracture of rib(s), sternum and thoracic spineS22(45,50]Female2Fracture of lumbar spine and pelvisS32(45,50]Female1Fracture of shoulder and upper armS42(45,50]Female160Fracture of forearmS52(45,50]Female1Dislocation, sprain and strain of joints and ligaments at wrist and hand levelS63(45,50]Female1Superficial injury of hip and thighS70(45,50]Male1Fracture of femurS72(45,50]Female34Fracture of femurS72(45,50]Male61Fracture of lower leg, including ankleS82(45,50]Female4Fracture of lower leg, including ankleS82(45,50]Male160Fracture of foot, except ankleS92(45,50]Male158Dislocation, sprain and strain of joints and ligaments at ankle and foot levelS93(45,50]Male20Crushing injury of ankle and footS97(45,50]Male1Fracture of spine, level unspecifiedT08(45,50]Female1Burn of wrist and handT23(45,50]Female33Burn of wrist and handT23(45,50]Male6Burn body region unspecifiedT30(45,50]Male1Burns classified according to extent of body surface involvedT31(45,50]Male1Poisoning by diuretics and other and unspecified drugs, medicaments and biological substancesT50(45,50]Female33Poisoning by diuretics and other and unspecified drugs, medicaments and biological substancesT50(45,50]Male6Toxic effect of contact with venomous animalsT63(45,50]Female33Toxic effect of contact with venomous animalsT63(45,50]Male8Certain early complications of trauma, not elsewhere classifiedT79(45,50]Female1Other specified complications of traumaT89(45,50]Female57Other specified complications of traumaT89(45,50]Male14Fracture of forearmS52(50,55]Female20Fracture of femurS72(50,55]Female40320Fracture of lower leg, including ankleS82(50,55]Female280Other injuries involving multiple body regions, not elsewhere classifiedT06(50,55]Male20Complications of procedures, not elsewhere classifiedT81(50,55]Male20Sequelae of injuries of headT90(50,55]Female160Certain early complications of trauma, not elsewhere classifiedT79(55,60]Male160Intracranial injuryS06(60,65]Female20Intracranial injuryS06(60,65]Male40Fracture of forearmS52(60,65]Female20Fracture of femurS72(60,65]Female20280Fracture of femurS72(60,65]Male160Fracture of lower leg, including ankleS82(60,65]Female20Dislocation, sprain and strain of joints and ligaments at ankle and foot levelS93(60,65]Male160Fracture of skull and facial bonesS02(65,70]Male160Fracture of femurS72(65,70]Female20Injury of other and unspecified intrathoracic organsS27(70,75]Male20Fracture of femurS72(70,75]Female160Fracture of shoulder and upper armS42(75,80]Female20Fracture of femurS72(75,80]Female20Fracture of femurS72(75,80]Male160Fracture of forearmS52(80,85]Female320",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Injury</span>"
    ]
  },
  {
    "objectID": "profile.html",
    "href": "profile.html",
    "title": "10  Health profile",
    "section": "",
    "text": "10.1 Putting it all together\nHealth profiles combine multiple indicators to allow comparison, usually between population or administrative units e.g. regions, hospitals, ethnic groups, age groups and provide tools to facilitate a range of comparison.\nUK health profiles (for example, Public Health Outcome Framework) offer a wide range of comparison:",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Health profile</span>"
    ]
  },
  {
    "objectID": "profile.html#putting-it-all-together",
    "href": "profile.html#putting-it-all-together",
    "title": "10  Health profile",
    "section": "",
    "text": "Between and within areas\nBetween age groups and genders",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Health profile</span>"
    ]
  },
  {
    "objectID": "profile.html#visualisation",
    "href": "profile.html#visualisation",
    "title": "10  Health profile",
    "section": "10.2 Visualisation",
    "text": "10.2 Visualisation\n\n\n\n\n\n\n\n\nComparison\nVisualisation\nComment\n\n\n\n\nSingle area, multiple indicators\nSpine or bullet chart\nIndicator values are scaled so that they can be directly compared. Single area (unit) values are usually encoded as a dot or line, plotted on a bar representing the range of values for all areas / units.\n\n\nMultiple areas, single indicator\nColumn / bar chart\nPlots can be ordered and plotted horizontally to enable rapid appraisal of relative performance. Confidence intervals can be added\n\n\nIndicator pairs / multiple indicators\nScatter plot or scatter plot matrices\nMay include smooths (lines representing fit to the data - common options are linear, loess and generalised additive models)\n\n\nSpatial variation\nChoropleth maps\nRequires boundary files and GIS tools\n\n\nOverview\nHeatmap / tile chart\nColour cells with statistical significance categories (e.g. high / low)\n\n\n\n\n\n\n\n\nWe will take the toolkit for plotting provided by the UKHSA which generates the charts used in the online version if the PHOF as a basis for plotting profiles. This is available at https://github.com/ukhsa-collaboration/fingertipscharts.\nNote: in the PHOF statistical significance is defined by whether the global average value (e.g. KSA) is contained with the confidence limits of the unit values (e.g. ’Asir region). It does not calculate limits for the global value. The rationale for this is explained in Public Health Data Science (2018)\n\n\nCode\n## install fingertipscharts\n## \n\nif(!require(\"fingertipscharts\")) devtools::install_github(\"https://github.com/ukhsa-collaboration/fingertipscharts\", force = TRUE)\n\nlibrary(fingertipscharts)\n\n\nTo use fingertipscharts data has to be in the right format.\nBar charts can be created using the compare_areas function\n\n\nCode\nsmok_rates |&gt;\n    compare_areas(area = region, value = value, lowerci = lowercl, upperci = uppercl, title = \"Rate of attendance at smoking clinics 18-44: F\")\n\nflu_coverage |&gt;\n    filter(gender == \"female\" & age == \"0-18\") |&gt;\n    compare_areas(area = region, value = value, lowerci = lowercl, upperci = uppercl, fill = gender, title = \"Flu vaccination coverage 0-18; F\")\n\n\n\n\n\n\n\n\n\n\n\n(a) Smoking rates\n\n\n\n\n\n\n\n\n\n\n\n(b) Paediatric flu coverage\n\n\n\n\n\n\nFigure 10.1: Using `compare-areas",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Health profile</span>"
    ]
  },
  {
    "objectID": "profile.html#data-overview",
    "href": "profile.html#data-overview",
    "title": "10  Health profile",
    "section": "10.3 Data overview",
    "text": "10.3 Data overview\nPHOF uses a heatmap (known as a “tartan rug” to display area by indicator summaries. The term tartan rug is used to refer to the colour scheme (red-amber-green) to denote statistical significance. The\n\n\nCode\nprof_data &lt;- bind_rows(smok_rates, flu_coverage) |&gt;\n    select(-c(11:13)) \n\n## calculate ksa values\nksa_values &lt;- prof_data |&gt;\n    group_by(indicator) |&gt;\n    reframe(ksa_values = 100000 * sum(n, na.rm = TRUE) / sum(pop))\n\n## join to data\nprof_data &lt;- prof_data |&gt;\n    left_join(ksa_values)\n\n## code for statistical significance\n\nprof_data &lt;- prof_data |&gt;\n    mutate(significance = case_when(lowercl &gt; ksa_values ~\"high\" ,\n                                     uppercl &lt; ksa_values~ \"low\",\n                                    TRUE ~ \"ns\"))\n\nhead(prof_data) |&gt;\n    gt::gt()\n\n\n\n\nTable 10.1: Required data format example\n\n\n\n\n\n\n\n\n\n\nindicator\nregion\nage\ngender\nn\npop\nvalue\nlowercl\nuppercl\ntimeperiod\nksa_values\nsignificance\n\n\n\n\nsmoking 18-44\n'Asir\n18-44\nfemale\nNA\n366324\nNA\nNA\nNA\n2023\n7.618658\nns\n\n\nsmoking 18-44\nAl Bahah\n18-44\nfemale\n28\n61969\n45.183882\n30.017729\n65.30573\n2023\n7.618658\nhigh\n\n\nsmoking 18-44\nAl Hudud ash Shamaliyah\n18-44\nfemale\n4\n70149\n5.702148\n1.553643\n14.59976\n2023\n7.618658\nns\n\n\nsmoking 18-44\nAl Jawf\n18-44\nfemale\n23\n103536\n22.214495\n14.077587\n33.33412\n2023\n7.618658\nhigh\n\n\nsmoking 18-44\nAl Madinah al Munawwarah\n18-44\nfemale\nNA\n387944\nNA\nNA\nNA\n2023\n7.618658\nns\n\n\nsmoking 18-44\nAl Mintaqah ash Sharqiyah\n18-44\nfemale\nNA\n877403\nNA\nNA\nNA\n2023\n7.618658\nns\n\n\n\n\n\n\n\n\n\n\n\n\n\nCode\nprof_data |&gt;\n    ggplot() +\n    geom_tile(aes(region, indicator, fill = significance)) +\n    scale_fill_manual(values = c(\"red\", \"darkgreen\", \"goldenrod\")) +\n    scale_x_discrete(position = \"top\") +\n    theme(axis.text.x = element_text(angle = 90, hjust = 0)) +\n    labs(y = \"\", x = \"\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPublic Health Data Science. 2018. “PHDS Guidance - Confidence Intervals - Public Health Profiles.” Public Health England.",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Health profile</span>"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Public Health Data Science. 2018. “PHDS Guidance -\nConfidence Intervals - Public Health Profiles.” Public Health\nEngland.",
    "crumbs": [
      "References"
    ]
  },
  {
    "objectID": "smoking-poc.html#contextualising",
    "href": "smoking-poc.html#contextualising",
    "title": "7  Smoking",
    "section": "7.2 Contextualising",
    "text": "7.2 Contextualising\nSmoking clinic attendance rates could be used as a proxy for population smoking rates if there is a relationship between attendance and prevalence. From the data",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Smoking</span>"
    ]
  }
]